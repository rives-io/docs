<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-riv/developing-cartridges" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.3.2">
<title data-rh="true">Developing cartridges | RIVES</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.rives.io/docs/riv/developing-cartridges"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Developing cartridges | RIVES"><meta data-rh="true" name="description" content="This tutorial will guide on how to setup your"><meta data-rh="true" property="og:description" content="This tutorial will guide on how to setup your"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.rives.io/docs/riv/developing-cartridges"><link data-rh="true" rel="alternate" href="https://docs.rives.io/docs/riv/developing-cartridges" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.rives.io/docs/riv/developing-cartridges" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://I3YBBP2IWW-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="RIVES RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="RIVES Atom Feed">



<link rel="search" type="application/opensearchdescription+xml" title="RIVES" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.5b3e164b.css">
<script src="/assets/js/runtime~main.6a05b518.js" defer="defer"></script>
<script src="/assets/js/main.d82487d5.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="RIVES Logo" class="pixelated themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_white.png" alt="RIVES Logo" class="pixelated themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/riv">Learn</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/playground">Playground</a><a href="https://rives.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link button button--secondary margin--xs">Play</a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/riv">RIV</a><button aria-label="Collapse sidebar category &#x27;RIV&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/riv/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/riv/getting-started">Getting started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/riv/developing-cartridges">Developing cartridges</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/riv/creating-a-game">Creating a game</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/riv/playing-sounds">Playing sounds</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/riv/handling-inputs">Handling inputs</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/riv"><span itemprop="name">RIV</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Developing cartridges</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Developing cartridges</h1>
<p>This tutorial will guide on how to setup your
development workflow and how to create your first cartridge.</p>
<p>By the end of this tutorial you will know how to create cartridge files,
compile cartridges, debug cartridges, benchmark cartridges,
inspect cartridges and how to use other programming languages to create cartridges.</p>
<p>This tutorial will begin quickly by running your first graphical application,
and then expand slowly about all the tools RIV SDK offers to develop cartridges,
you will learn some new interesting RIVEMU options on the go.</p>
<p>If you have not installed RIVEMU yet, please read
the <a href="/docs/riv/getting-started">getting started page</a> first.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-your-first-application-in-c">Creating your first application in C<a href="#creating-your-first-application-in-c" class="hash-link" aria-label="Direct link to Creating your first application in C" title="Direct link to Creating your first application in C">​</a></h2>
<p>Technically you can use any programming supported by Linux RISC-V to create cartridges,
however RIV offers its standard API in C with <code>libriv</code>,
therefore you can use C to create RIV cartridges.
This tutorial will focus on using just C to getting started and understand the basics,
later it will expand on how to use other programming languages.</p>
<p>Let&#x27;s begin creating a file named <code>hello.c</code> with the following contents:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(189, 147, 249);font-style:italic">include</span><span class="token macro property"> </span><span class="token macro property string" style="color:rgb(255, 121, 198)">&lt;riv.h&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// clear screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">riv_clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_COLOR_BLACK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token comment" style="color:rgb(98, 114, 164)">// draw hello world</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token function" style="color:rgb(80, 250, 123)">riv_draw_text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello world!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RIV_SPRITESHEET_FONT_5X7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RIV_CENTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RIV_COLOR_WHITE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">riv_present</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The standard RIV OS comes with a JIT for C programming language called <code>riv-jit-c</code>,
so you can run this example directly without having to actually compile it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> riv-jit-c hello.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see a screen popup, and that is it, your first hello world program running in RIV!</p>
<p>The <code>-exec</code> option overrides the standard machine entrypoint to execute a custom command,
in this case we are executing <code>riv-jit-c</code> to run the <code>hello.c</code> file.
The <code>-workspace</code> option exposes current directory files into the machine,
it will be explained in detail in the next section.</p>
<p>The C code presented so far should be self explanatory,
we have a line that clear the screen,
another to draw a text and finally a line to present the cartridge frame.
You can read the full <em>libriv</em> C API in its
header at <a href="https://github.com/rives-io/riv/blob/main/libriv/riv.h" target="_blank" rel="noopener noreferrer">riv.h</a>,
for now we won&#x27;t give much details on its functions,
let&#x27;s continue understanding the RIV development workflow first.</p>
<div align="center"><iframe src="https://emulator.rives.io/#simple=true&amp;cartridge=cartridges/hello-c.sqfs" allowfullscreen="" class="rivemu-frame"></iframe></div>
<p>You can test above the cartridge for this chapter.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="interactive-terminal-with-workspaces">Interactive terminal with workspaces<a href="#interactive-terminal-with-workspaces" class="hash-link" aria-label="Direct link to Interactive terminal with workspaces" title="Direct link to Interactive terminal with workspaces">​</a></h2>
<p>Notice in the last example the <code>-workspace</code> option,
it mounts the current working directory from your host to the <code>/workspace</code> directory in the RIV machine,
to make development easier.</p>
<p>This is a good time show how RIV is also a Linux,
where you can work in its own terminal when combining with the <code>-it</code> option:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-it</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>-it</code> options standards for interactive terminal,
it gives the ability to type commands inside a terminal running inside a running RIV machine.
You can type really almost any Linux command, for example:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivos:/workspace# uname -mns</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Linux rivos riscv64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivos:/workspace# pwd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/workspace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivos:/workspace# ls *.c</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hello.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice the <code>hello.c</code> from last example is there,
because <code>-workspace</code> mounted the current working directory,
while we are inside a RISC-V 64-bit Linux machine.</p>
<p>You can also run your <code>hello.c</code> directly from the shell inside riv:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">riv-jit-c hello.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If you edit the file <code>hello.c</code> in a file editor in your host,
the changes will also take effect inside RIV OS.
But why would you want to run commands inside the RIV OS terminal?
Well because the RIV also has the RIV SDK that comes with lot of utilities
for developing cartridges,
tools for compiling RISC-V binaries, compressing files into cartridge archives,
and debuggers for debugging RISC-V applications.</p>
<p>After you experiment with it, make sure to exit the interactive terminal session
to continue to the next section.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="installing-the-riv-sdk">Installing the RIV SDK<a href="#installing-the-riv-sdk" class="hash-link" aria-label="Direct link to Installing the RIV SDK" title="Direct link to Installing the RIV SDK">​</a></h2>
<p>RIVEMU comes with a builtin and minimal operating system called RIV OS,
this RIV OS contains the bare minimal libraries and utilities
to run cartridges, but in other to actually create cartridges
you need many more tools like programming language compilers
and archive compressors.</p>
<p>You may also want to customize the RIV SDK with your own Linux tools,
such as other programming languages (e.g Rust, Zig, Nim..).
With the SDK you can do this, because it&#x27;s writable and customizable,
while the builtin standard minimal RIV OS is read-only.</p>
<p>Bear in mind the standard SDK is very large (about 500MB),
because it contains compilers, debuggers, editors, and many other tools for development only.</p>
<p>Let&#x27;s download the SDK and try it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-O</span><span class="token plain"> rivos-sdk.ext2 https://github.com/rives-io/riv/releases/latest/download/rivos-sdk.ext2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token operator">=</span><span class="token plain">rivos-sdk.ext2 </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> gcc </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You probably got an output that contains something like:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">gcc (Alpine 13.2.1_git20240309) 13.2.1 20240309</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (C) 2023 Free Software Foundation, Inc.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This is free software; see the source for copying conditions.  There is NO</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>-sdk=rivos-sdk.ext2</code> overrides the standard operating system
to use the SDK operating system,
the command <code>-exec gcc --version</code> should show the GCC C compiler version
that is included in the SDK, which was not included in the minimal RIV OS.</p>
<p>Lets now install this SDK globally, to make available in any terminal in your system:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(189, 147, 249)">$HOME</span><span class="token plain">/.riv/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mv</span><span class="token plain"> rivos-sdk.ext2 </span><span class="token environment constant" style="color:rgb(189, 147, 249)">$HOME</span><span class="token plain">/.riv/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;export RIVEMU_SDK=$HOME/.riv/rivos-sdk.ext2&#x27;</span><span class="token plain"> </span><span class="token operator">&gt;&gt;</span><span class="token plain"> </span><span class="token environment constant" style="color:rgb(189, 147, 249)">$HOME</span><span class="token plain">/.bashrc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">RIVEMU_SDK</span><span class="token operator">=</span><span class="token environment constant" style="color:rgb(189, 147, 249)">$HOME</span><span class="token plain">/.riv/rivos-sdk.ext2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When setting the environment <code>RIVEMU_SDK</code>,
RIVEMU will be able to auto detect and load the SDK,
so you can use from anywhere in your system,
let&#x27;s try it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> /usr/lib/libriv.so version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see and output similar to:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">0.3.0</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We have introduced new command line options here.
The <code>-quiet</code> makes RIVEMU less verbose because we just
want to see an output from a command executed inside the machine.
The <code>-no-window</code> makes RIVEMU never create a graphical window,
because we want to just run a console application in this case, that is, we won&#x27;t be playing a cartridge.
The <code>-sdk</code> without a filename will try to read the SDK filesystem from <code>RIVEMU_SDK</code> environment variable.
The <code>-exec /usr/lib/libriv.so version</code> will execute a command to check the <code>libriv</code> version in the OS.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-your-first-cartridge">Creating your first cartridge<a href="#creating-your-first-cartridge" class="hash-link" aria-label="Direct link to Creating your first cartridge" title="Direct link to Creating your first cartridge">​</a></h2>
<p>Now with the SDK installed,
let&#x27;s get back to the <code>hello.c</code> example and actually turn it into a cartridge.</p>
<p>Every cartridge must have an <em>entrypoint</em> to actually run,
first let create a shell script file named <code>0-entry.sh</code>:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;riv-jit-c hello.c&quot;</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain">-entry.sh</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> +x </span><span class="token number">0</span><span class="token plain">-entry.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Why the name is <code>0-entry.sh</code>? When running a cartridge,
RIV actually executes the first executable file in a cartridge,
sorted alphabetically.
In case you have other executable binaries in your cartridge,
they could executed before the entrypoint as a mistake,
so it is recommended to make the entrypoint be the first file
when ordering its files by name.</p>
<p>Now lets invoke RIVEMU to actually compress both <code>0-entry.sh</code> and <code>hello.c</code> into
a cartridge archive.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> riv-mksqfs </span><span class="token number">0</span><span class="token plain">-entry.sh hello.c hello.sqfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <code>riv-mksqfs</code> command should create the actual cartridge <code>.sqfs</code> file, lets inspect it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;ls -l hello.sqfs &amp;&amp; file hello.sqfs&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>It should output something similar to:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">-rw-r--r--    </span><span class="token number">1</span><span class="token plain"> user     user          </span><span class="token number">4096</span><span class="token plain"> Apr </span><span class="token number">19</span><span class="token plain"> </span><span class="token number">20</span><span class="token plain">:48 hello.sqfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">hello.sqfs: Squashfs filesystem, little endian, version </span><span class="token number">4.0</span><span class="token plain">, zlib compressed, </span><span class="token number">434</span><span class="token plain"> bytes, </span><span class="token number">3</span><span class="token plain"> inodes, blocksize: </span><span class="token number">131072</span><span class="token plain"> bytes, created: Thu Jan  </span><span class="token number">1</span><span class="token plain"> 00:00:00 </span><span class="token number">1970</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can see the cartridge file has 4096 bytes,
this is because cartridges actually are SquashFS compressed filesystem,
which are always saved in multiple of 4KB,
this also means the minimum size for a cartridge is always 4KB.
Notice the cartridge contents were compressed with <em>zlib</em>.</p>
<p>The compression could also be tuned to generate smaller cartridges,
for example you could use more aggressive compression appending <code>-comp xz</code>,
like <code>riv-mksqfs 0-entry.sh hello.c hello.sqfs -comp xz</code>
for checking available compressions read <code>mksquashfs -help</code></p>
<p>Now lets finally run it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu hello.sqfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If everything worked, you should see &quot;hello world!&quot; screen show up.
This is your first cartridge!</p>
<p>This cartridge file is also the one you should upload on RIVES.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="testing-cartridges-in-a-web-browser">Testing cartridges in a web browser<a href="#testing-cartridges-in-a-web-browser" class="hash-link" aria-label="Direct link to Testing cartridges in a web browser" title="Direct link to Testing cartridges in a web browser">​</a></h2>
<p>Having a cartridge running locally in the RIVEMU is great,
but most players will probably play your cartridges in a Web Browser,
luckily RIVEMU was also ported to WebAssembly,
RIV has a test page for you to test a cartridge in the browser
at the <a href="https://emulator.rives.io" target="_blank" rel="noopener noreferrer">emulator testing page</a>.
Go there and search for the &quot;Upload&quot; button in the &quot;Cartridge&quot; section,
use it to upload your <code>hello.sqfs</code>.</p>
<p>If everything works fine, you should be able to see the &quot;hello world!&quot;
in the browser.
Every time you finish developing a cartridge,
it&#x27;s recommended to actually test it in the browser,
because the performance can be different than running natively,
usually performance drops by 20% or more.</p>
<p>Also in the browser you can even use game pads to test your game!
If you have a PS4, Xbox or Nintendo Switch controller,
just plug in your computer and most browser supports them through
the HTML5 Gamepad API specification.
Before trying this, you should check if your game pad is working in your browser
in third party services such as
<a href="https://hardwaretester.com/gamepad" target="_blank" rel="noopener noreferrer">this game pad tester</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compiling-cartridges">Compiling cartridges<a href="#compiling-cartridges" class="hash-link" aria-label="Direct link to Compiling cartridges" title="Direct link to Compiling cartridges">​</a></h2>
<p>In our first cartridge <code>hello.sqfs</code>, we used <code>riv-jit-c</code> to run <code>hello.c</code>,
although this was very easy we can actually compile it into a <code>hello</code> RISC-V executable binary:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> gcc hello.c </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token plain"> hello </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-lriv</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The command <code>gcc hello.c -o hello -lriv</code> compiles <code>hello.c</code>
source code into <code>hello</code> Linux RISC-V ELF binary linked to <code>libriv</code>.</p>
<p>Before generating a cartridge for it, let&#x27;s test it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> ./hello</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then you should see a hello world screen like before.
Now let&#x27;s actually compile a cartridge and run it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> riv-mksqfs hello hello-compiled.sqfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu hello-compiled.sqfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Like before you should see hello world screen,
but this cartridge is different from the first one,
because it used ahead of time compilation now,
which makes your cartridge faster to load and run and smaller for cartridges with lot of code.
We recommend to use JIT just for prototyping,
when possible your final release cartridge should be statically compiled.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compiling-optimized-cartridges">Compiling optimized cartridges<a href="#compiling-optimized-cartridges" class="hash-link" aria-label="Direct link to Compiling optimized cartridges" title="Direct link to Compiling optimized cartridges">​</a></h2>
<p>In last example we compiled a C code, but we did not enable any optimization,
lets enable them not only for improve its performance, but also to reduce its final size,
so we can make a cartridge smaller.
RIV SDK comes with a tool to assist you choosing C compilers flags to
to generate optimized and small binaries called <code>riv-opt-flags</code>.</p>
<p>Lets recompile a new cartridge for the last example again using these tools:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">alias</span><span class="token plain"> rivemu-exec</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;rivemu -quiet -no-window -sdk -workspace -exec&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu-exec </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;gcc hello.c -o hello-optimized $(riv-opt-flags -Ospeed)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu-exec riv-strip hello-optimized</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu-exec riv-mksqfs hello-optimized hello-optimized.sqfs</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu hello-optimized.sqfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s break what happened:</p>
<ol>
<li>In the first line we create the alias <code>rivemu-exec</code>, a shortcut to invoke commands inside RIV OS.</li>
<li>In the second line we compile <code>hello.c</code> again, but this time to <code>hello-optimized</code> using compiler flags from <code>riv-opt-flags -Ospeed</code>, this will supply compiler flags to optimized for speed because we passed <code>-Ospeed</code>, this tool also accepts <code>-Osize</code> to optimize for size, and <code>-Odebug</code> to optimize for debugging.</li>
<li>In the third line we strip unwanted data from the ELF binary <code>hello-optimized</code>, this should compress the file a little more.</li>
<li>In the fourth line we create the cartridge <code>hello-optimized.sqfs</code></li>
<li>Finally in the last line we test it.</li>
</ol>
<p>Lets compare the final with old one we created:</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">rivemu-exec </span><span class="token command bash language-bash string" style="color:rgb(255, 121, 198)">&#x27;unsquashfs -stat hello-compiled.sqfs | grep bytes&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token output">Filesystem size 3517 bytes (3.43 Kbytes / 0.00 Mbytes)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output"></span><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">rivemu-exec </span><span class="token command bash language-bash string" style="color:rgb(255, 121, 198)">&#x27;unsquashfs -stat hello-optimized.sqfs | grep bytes&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token output">Filesystem size 1661 bytes (1.62 Kbytes / 0.00 Mbytes)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice the data in <code>hello-optimized.sqfs</code> cartridge is smaller than <code>hello-compiled.sqfs</code>.
However if you take a look with <code>ls -la</code>, you will notice both cartridges files are still at 4KB,
this is because SquashFS files add 0 padding at the end, to make us able to use the <code>mount</code> command.
This cartridge is very small, only in a more complex one you would see the benefits.</p>
<p>If you can afford, prefer to use <code>-Ospeed</code> to optimize for performance,
use <code>-Osize</code> only if you really want to reduce its size as priority,
and use <code>-Odebug</code> only to debug while in development.</p>
<p>On RIVES it is recommended to upload optimized and small cartridges to reduce costs,
and improve its verification performance.
Even though both are 4KB, the ones containing zeros will cost less to upload on RIVES,
because transactions with zeros in them cost less in some blockchain base layers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="debugging-cartridges">Debugging cartridges<a href="#debugging-cartridges" class="hash-link" aria-label="Direct link to Debugging cartridges" title="Direct link to Debugging cartridges">​</a></h2>
<p>In the last example we mentioned <code>-Odebug</code> to optimize for debugging,
but how can you debug? Well you can just use the GDB debugger.</p>
<p>Lets compile again our minimal <code>hello.c</code> program and debug it with GDB:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;gcc hello.c -o hello-debug $(riv-opt-flags -Odebug)&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-it</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> gdb </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-silent</span><span class="token plain"> ./hello-debug</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This should open <code>gdb</code> session so you can debug the cartridge,
here is a copy of a session demonstrating how to step over each function:</p>
<div class="language-c codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ rivemu </span><span class="token operator">-</span><span class="token plain">quiet </span><span class="token operator">-</span><span class="token plain">sdk </span><span class="token operator">-</span><span class="token plain">workspace </span><span class="token operator">-</span><span class="token plain">it </span><span class="token operator">-</span><span class="token plain">exec gdb </span><span class="token operator">-</span><span class="token plain">silent </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">/</span><span class="token plain">hello</span><span class="token operator">-</span><span class="token plain">debug</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reading symbols from </span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token operator">/</span><span class="token plain">hello</span><span class="token operator">-</span><span class="token plain">debug</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">break</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1</span><span class="token plain"> at </span><span class="token number">0x8b0</span><span class="token operator">:</span><span class="token plain"> file hello</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> line </span><span class="token number">6.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> run</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Starting program</span><span class="token operator">:</span><span class="token plain"> </span><span class="token operator">/</span><span class="token plain">workspace</span><span class="token operator">/</span><span class="token plain">hello</span><span class="token operator">-</span><span class="token plain">debug</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> at hello</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">c</span><span class="token operator">:</span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">6</span><span class="token plain">           </span><span class="token function" style="color:rgb(80, 250, 123)">riv_clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_COLOR_BLACK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">8</span><span class="token plain">           </span><span class="token function" style="color:rgb(80, 250, 123)">riv_draw_text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello world!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RIV_SPRITESHEET_FONT_5X7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RIV_CENTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> RIV_COLOR_WHITE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">9</span><span class="token plain">       </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">riv_present</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> step</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Breakpoint </span><span class="token number">1.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">main</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> at hello</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">c</span><span class="token operator">:</span><span class="token number">6</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token number">8</span><span class="token plain">           </span><span class="token function" style="color:rgb(80, 250, 123)">riv_clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_COLOR_BLACK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">gdb</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> p riv</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">frame</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">$</span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice in this session we break at the program startup, and then run each line by line.
At the end we print which frame we are with.
In the end, you can debug cartridges normally as debugging C programs.</p>
<p>If you debug a cartridge with a <em>tape</em>,
you could inspect the game frame by frame.
Sounds useful for debugging nasty bugs while developing a game right?
For example, imagine a player found a bug in your game,
you could just ask him to record a tape of the bug,
then you can use it to debug frame by frame.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="inspecting-cartridges">Inspecting cartridges<a href="#inspecting-cartridges" class="hash-link" aria-label="Direct link to Inspecting cartridges" title="Direct link to Inspecting cartridges">​</a></h2>
<p>What if you got a cartridge from someone and would like to inspect it?
You can use RIVEMU in interactive mode for that.
Lets inspect the <code>antcopter.sqfs</code> cartridge
that was previously downloaded in the getting started page:</p>
<div class="language-shell-session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell-session codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token command shell-symbol important">$</span><span class="token command"> </span><span class="token command bash language-bash">rivemu </span><span class="token command bash language-bash parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token command bash language-bash"> </span><span class="token command bash language-bash parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-it</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token output">rivos-sdk:/workspace# mount antcopter.sqfs /cartridge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">rivos-sdk:/workspace# cd /cartridge</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">rivos:/cartridge# ls -l</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">total 43</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">-rwxr-xr-x    1 root     root         42632 Jan  1  1970 antcopter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">-rw-r--r--    1 root     root          1006 Jan  1  1970 info.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">rivos:/cartridge# file antcopter</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">antcopter: ELF 64-bit LSB pie executable, UCB RISC-V, RVC, double-float ABI, version 1 (SYSV), dynamically linked, interpreter /lib/ld-musl-riscv64.so.1, no section header</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">rivos:/cartridge# jq &lt; info.json</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">  &quot;name&quot;: &quot;Antcopter&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">  &quot;summary&quot;: &quot;A 2D speed run platform game where you are a little ant that can glide in the air&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token output">...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The text above is a copy of an interactive session inspecting <code>antcopter.sqfs</code>.
You can see it has only 2 files, yhe <code>antcopter</code> RISC-V binary that contains the game,
and <code>info.json</code> JSON file that contains some metadata,
this metadata is used on RIVES to create a catalog of games,
cartridges are recommended to have this metadata included to distribute them on RIVES.</p>
<p>Go ahead and run <code>/cartridge/antcopter</code> command in the interactive terminal,
you should be able to play it.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="benchmarking-cartridges">Benchmarking cartridges<a href="#benchmarking-cartridges" class="hash-link" aria-label="Direct link to Benchmarking cartridges" title="Direct link to Benchmarking cartridges">​</a></h2>
<p>It&#x27;s a good practice to measure the performance of your cartridge before distributing it,
for two reasons.
One because you have a quota limit on how much computation a cartridge tape can process,
and also because you want your cartridges execution to be lightweight enough
to run with acceptable performance on different systems the emulator is running on.</p>
<p>RIVEMU has the command <code>-bench</code> to help benchmarking your cartridge,
it&#x27;s recommended to benchmark only your final cartridge <code>.sqfs</code> file,
lets benchmark <code>hello-optimized.sqfs</code>:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-bench</span><span class="token plain"> hello-optimized.sqfs</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should get an output similar to:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=1 fps=0.97 cpu_cost=4190.38MIPS cpu_speed=372.25MIPS cpu_usage=18.15% cpu_quota=0.07%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=16 fps=59.99 cpu_cost=2.30MIPS cpu_speed=412.79MIPS cpu_usage=0.56% cpu_quota=0.07%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=31 fps=59.99 cpu_cost=2.31MIPS cpu_speed=384.98MIPS cpu_usage=0.60% cpu_quota=0.07%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=46 fps=59.97 cpu_cost=2.32MIPS cpu_speed=407.28MIPS cpu_usage=0.57% cpu_quota=0.07%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=62 fps=59.99 cpu_cost=2.30MIPS cpu_speed=420.51MIPS cpu_usage=0.55% cpu_quota=0.08%</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Let&#x27;s break down this information:</p>
<ul>
<li><code>frame</code>: it&#x27;s the frame processed so far,
cartridges by default usually process 60 frames per second, but this can be customized.</li>
<li><code>fps</code>: it&#x27;s how much frames per second your computer is capable of processing,
usually we want this number to be close to 60.</li>
<li><code>cpu_cost</code>: it&#x27;s how much CPU instructions costed to process exactly 1 second of computation,
it&#x27;s measured in MIPS (million instructions per second),
usually we want this number to be low and below <code>cpu_speed</code>,
high values means the cartridge is sub optimized,
cartridges must try to keep this value below 128MIPS when running to allow everyone to run it smoothly.</li>
<li><code>cpu_speed</code>: it&#x27;s how much CPU instruction per second your computer is capable of emulating,
this value may vary on the system you are running,
RIV is designed to run on system that is at least capable of running 128MIPS,
systems that are not able to emulate at that speed may experience stuttering when playing heavy cartridges.</li>
<li><code>cpu_usage</code>: it&#x27;s how much of the CPU the cartridge is using,
if this value is above 90%, you may experience stuttering when playing the cartridge.</li>
<li><code>cpu_quota</code>: it&#x27;s how much CPU computation quota has been processed so far,
RIV hardware spec set the quota to be 96 billion CPU instructions,
when CPU quota reaches 100%, the game halts immediately.</li>
</ul>
<p>If you look closely the first frame always costs more MIPS,
because the machine has to boot and load the game.
After the first frame the CPU quota keeps increasing slowly,
it will increase indefinitely until the game ends.
The FPS should remain stable most of the time.
The CPU speed may vary a lot, because different instructions has different speeds,
and also because your system may be busy processing other programs.
The CPU cost should remain stable for well designed cartridges,
cartridges that increase CPU cost at random frames may experience
stuttering, degrading game play quality.</p>
<p>This RIVEMU web page can also show all this information when testing a cartridge.</p>
<p>The <code>hello-optimized.sqfs</code> is not doing much, if you play a heavy cartridge,
like DOOM, you will see numbers similar to:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=1 fps=0.18 cpu_cost=12404.20MIPS cpu_speed=567.54MIPS cpu_usage=11.20% cpu_quota=0.37%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=10 fps=33.75 cpu_cost=55.21MIPS cpu_speed=619.72MIPS cpu_usage=8.59% cpu_quota=0.38%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=19 fps=35.99 cpu_cost=56.00MIPS cpu_speed=630.41MIPS cpu_usage=9.13% cpu_quota=0.40%</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[RIVEMU] frame=28 fps=33.76 cpu_cost=56.01MIPS cpu_speed=622.77MIPS cpu_usage=8.68% cpu_quota=0.41%</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>So DOOM costs about 56MIPS, still way below the recommended max amount of 128MIPS,
most cartridges processing probably will not cost more CPU than that.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="customizing-sdk-to-install-new-tools">Customizing SDK to install new tools<a href="#customizing-sdk-to-install-new-tools" class="hash-link" aria-label="Direct link to Customizing SDK to install new tools" title="Direct link to Customizing SDK to install new tools">​</a></h2>
<p>You have learned so far how to
create cartridges, compile them, compress them, inspect them, debug them and finally benchmark them.
All of this you did using tools we already provide in the SDK,
however you can also add your own tools and programming languages to the SDK,
while you could use them from outside, using from inside the RIVEMU RISC-V machine
you know the tool will work correctly for RISC-V.</p>
<p>Lets download the Nim programming language, and in the section below we will use it to compile a cartridge.</p>
<p>First let&#x27;s get into a RIVEMU shell with networking support:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-net</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-persist</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-it</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice the added <code>-net</code> here, this enables networking so you can install packages from the internet.
Notice we also added the <code>-persist</code> option,
this will make changes to the SDK persist, even when you exit the machine.
Up until now any changes made in the filesystem were being
discarded after the emulator quits.</p>
<p>Inside a RIV SDK interactive terminal with networking, run <code>apk add nim</code> to install Nim compiler,
it will download and install Nim package from Alpine Linux package manager,
and then test it with <code>nim -v</code>, here is the session output:</p>
<div class="language-shell_session codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-shell_session codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ rivemu -quiet -sdk -workspace -net -persist -it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivos-sdk:/workspace# apk add nim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fetch https://dl-cdn.alpinelinux.org/alpine/edge/main/riscv64/APKINDEX.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fetch https://dl-cdn.alpinelinux.org/alpine/edge/community/riscv64/APKINDEX.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fetch https://dl-cdn.alpinelinux.org/alpine/edge/testing/riscv64/APKINDEX.tar.gz</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(1/3) Installing libucontext (1.2-r3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(2/3) Installing libucontext-dev (1.2-r3)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(3/3) Installing nim (2.0.2-r0)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Executing busybox-1.36.1-r25.trigger</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">OK: 321 MiB in 93 packages</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivos-sdk:/workspace# nim -v</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nim Compiler Version 2.0.2 [Linux: riscv64]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Compiled at 2024-04-03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright (c) 2006-2023 by Andreas Rumpf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">active boot switches: -d:release</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You can also customize your own set of tools in the SDK.
Beware that using <code>-persist</code> you are modifying the original SDK,
if you want to rollback the stock defaults, just download <code>rivos-sdk.ext2</code> again.</p>
<p>But did the changes really persist? Let&#x27;s check:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">$ rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> nim </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Nim Compiler Version </span><span class="token number">2.0</span><span class="token plain">.2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">Linux: riscv64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Compiled at </span><span class="token number">2024</span><span class="token plain">-04-03</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Copyright </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">c</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token number">2006</span><span class="token plain">-2023 by Andreas Rumpf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">active boot switches: </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d:release</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Yes, it&#x27;s there, Nim compiler is now part of our customized SDK.</p>
<p>As you install new stuff to the SDK, its disk will grow
and eventually you might be out of disk space.
To fix this, you can increase the size of SDK disk with the following command:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable function" style="color:rgb(80, 250, 123);font-style:italic">dirname</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> $RIVEMU_SDK</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> resize2fs </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> rivos-sdk.ext2 1024M</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This will set the SDK disk size to 1024M, which should double from its default size.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-other-programming-languages">Using other programming languages<a href="#using-other-programming-languages" class="hash-link" aria-label="Direct link to Using other programming languages" title="Direct link to Using other programming languages">​</a></h2>
<p>We can use any programming language to make cartridges,
as long it compiles to a self contained RISC-V ELF binary,
or its cartridge brings together all dependencies it needs.</p>
<p>In last section we installed Nim,
we could have installed any other programming as well.
Since our customized SDK already have Nim,
let&#x27;s show how you can use Nim to create cartridges,
even though there is no official support for Nim in RIV.</p>
<p>Lets just port our hello example, create this file <code>hello.nim</code>:</p>
<div class="language-nim codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-nim codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">proc</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">riv_present</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> bool </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{.</span><span class="token plain">importc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> header</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;riv.h&gt;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">proc</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">riv_clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">col</span><span class="token operator">:</span><span class="token plain"> uint32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> void </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{.</span><span class="token plain">importc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> header</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;riv.h&gt;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">proc</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">riv_draw_text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">text</span><span class="token operator">:</span><span class="token plain"> cstring</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> sps_id</span><span class="token operator">:</span><span class="token plain"> uint64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> anchor</span><span class="token operator">:</span><span class="token plain"> uint32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> x</span><span class="token operator">:</span><span class="token plain"> int64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y</span><span class="token operator">:</span><span class="token plain"> int64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> size</span><span class="token operator">:</span><span class="token plain"> int64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> col</span><span class="token operator">:</span><span class="token plain"> int64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"> void </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{.</span><span class="token plain">importc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> header</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;riv.h&gt;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RIV_COLOR_BLACK</span><span class="token operator">:</span><span class="token plain"> uint32 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RIV_COLOR_WHITE</span><span class="token operator">:</span><span class="token plain"> uint32 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RIV_CENTER</span><span class="token operator">:</span><span class="token plain"> uint32 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    RIV_SPRITESHEET_FONT_5X7</span><span class="token operator">:</span><span class="token plain"> uint64 </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">4095</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> true</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># clear screen</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">riv_clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token function" style="color:rgb(80, 250, 123)">ord</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_COLOR_BLACK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># draw hello world</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token function" style="color:rgb(80, 250, 123)">riv_draw_text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello world!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ord</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_SPRITESHEET_FONT_5X7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ord</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_CENTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">ord</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">RIV_COLOR_WHITE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token operator">not</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">riv_present</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token operator">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">break</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Did you notice this code looks similar to Python?
That is because Nim syntax is inspired by Python syntax,
but don&#x27;t be fooled, this is a statically compiled programming language.</p>
<p>Let&#x27;s compile this file with Nim compiler using our customized SDK, and run it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-quiet</span><span class="token plain"> -no-window </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-sdk</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> nim compile </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--opt:size</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--mm:none</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d:release</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--passL:-lriv</span><span class="token plain"> --out:hello-nim hello.nim</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> ./hello-nim</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>You should see a screen with &quot;hello world!&quot; again, but this time the original source code was made in Nim.</p>
<p>We could have installed other system programming languages, such as
Rust, Zig and Nelua.
These are the ones recommended because they are compiled.
You can also use scripting programming languages, which will be covered in the next section.</p>
<p>By the way, the official SDK come for compilers for C, C++ and Nelua.
Nelua even already has bindings for all <code>riv.h</code> from <code>libriv</code> in the SDK.
The RIV minimal OS also comes with Lua 5.4 interpreter and a JIT for C11
<a href="https://github.com/vnmakarov/mir" target="_blank" rel="noopener noreferrer">with MIR JIT</a>.
But it&#x27;s recommended to start using programming languages you are already familiar,
learning <code>libriv</code> API plus a programming language might be too much to do at once.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="using-scripting-languages">Using scripting languages<a href="#using-scripting-languages" class="hash-link" aria-label="Direct link to Using scripting languages" title="Direct link to Using scripting languages">​</a></h2>
<p>In the last section we mentioned that RIV OS comes with Lua programming language,
let&#x27;s try it.
In other to call functions from the C library <code>libriv</code>,
we will use the <a href="https://github.com/q66/cffi-lua" target="_blank" rel="noopener noreferrer">cffi-lua</a> to import and call C functions.</p>
<p>First create the file <code>hello.lua</code> to be used with LuaJIT:</p>
<div class="language-lua codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-lua codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">#!/usr/bin/lua5.4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">local</span><span class="token plain"> ffi </span><span class="token operator">=</span><span class="token plain"> require </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;cffi&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ffi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">cdef</span><span class="token string" style="color:rgb(255, 121, 198)">[[</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">typedef enum riv_color_id {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  RIV_COLOR_BLACK       = 0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  RIV_COLOR_WHITE       = 1,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">} riv_color_id;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">typedef enum riv_spritesheet_id {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  RIV_SPRITESHEET_FONT_5X7 = 4095,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">} riv_spritesheet_id;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">typedef enum riv_align {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">  RIV_CENTER = 4,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">} riv_align;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">typedef struct riv_vec2i {int64_t x; int64_t y;} riv_vec2i;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">bool riv_present();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">void riv_clear(uint32_t col);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">riv_vec2i riv_draw_text(const char* text, uint64_t sps_id, riv_align anchor, int64_t x, int64_t y, int64_t size, int64_t col);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">]]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">local</span><span class="token plain"> L </span><span class="token operator">=</span><span class="token plain"> ffi</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">load</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;riv&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">repeat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">riv_clear</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">RIV_COLOR_BLACK</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">riv_draw_text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;hello world!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">RIV_SPRITESHEET_FONT_5X7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">RIV_CENTER</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">128</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">RIV_COLOR_WHITE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">until</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> L</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token function" style="color:rgb(80, 250, 123)">riv_present</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Notice in this code the at the beginning we are manually importing <code>libriv</code> APIs,
at the bottom it&#x27;s just again our hello example, lets run it:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> +x hello.lua</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">rivemu </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-workspace</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-exec</span><span class="token plain"> ./hello.lua</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And again, you will see the &quot;hello world!&quot; screen!</p>
<p>As mentioned before, Lua is contained the official RIV OS,
but interpreters for other programming languages are not.
If you would like to use Python or JavaScript for example,
you will have to embed their interpreter inside the cartridge which could make it very big,
this is it&#x27;s recommended to use just official supported interpreted languages,
or use interpreted languages small enough to embed in a cartridge.
There exists tiny versions for both Python and Javascript,
they are <a href="https://micropython.org/" target="_blank" rel="noopener noreferrer">Micropython</a> and <a href="https://bellard.org/quickjs/" target="_blank" rel="noopener noreferrer">QuickJS</a>,
I would recommend embedding those inside cartridges instead,
maybe we could add official RIV support for them in the future.</p>
<p>If you have read this entire page, you have by now:</p>
<ul>
<li>run <code>hello.c</code> using a <code>riv-jit-c</code></li>
<li>run <code>hello.c</code> compiled with GCC compiler</li>
<li>run <code>hello.c</code> compiled with GCC compiler with optimizations</li>
<li>run <code>hello.nim</code> compiled with Nim compiler</li>
<li>run <code>hello.lua</code> interpreted with Lua</li>
</ul>
<p>It&#x27;s recommended to use C for now,
but if you are adventurous,
you could use other languages as long as work out the bindings.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="porting-other-games">Porting other games<a href="#porting-other-games" class="hash-link" aria-label="Direct link to Porting other games" title="Direct link to Porting other games">​</a></h2>
<p>You can port existing games to RIV, as long you have the code to compile it to RISC-V,
have all the tools you need in the SDK
and the game works under all the constraints presented so far.
Porting a game basically is a matter of changing the graphics, audio and input APIs
to use <code>libriv</code> C API.</p>
<p>The <a href="https://github.com/rives-io/cartridge-freedoom" target="_blank" rel="noopener noreferrer">DOOM cartridge repository</a>
repository should serve as an example
on how a source code that was originally using the SDL library for handling
graphics/audio/input,
was ported to use the RIV library.</p>
<p>In the next chapter we will learn more details about the libriv API
while creating a Snake game.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/riv/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Getting started</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/riv/creating-a-game"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Creating a game</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-your-first-application-in-c" class="table-of-contents__link toc-highlight">Creating your first application in C</a></li><li><a href="#interactive-terminal-with-workspaces" class="table-of-contents__link toc-highlight">Interactive terminal with workspaces</a></li><li><a href="#installing-the-riv-sdk" class="table-of-contents__link toc-highlight">Installing the RIV SDK</a></li><li><a href="#creating-your-first-cartridge" class="table-of-contents__link toc-highlight">Creating your first cartridge</a></li><li><a href="#testing-cartridges-in-a-web-browser" class="table-of-contents__link toc-highlight">Testing cartridges in a web browser</a></li><li><a href="#compiling-cartridges" class="table-of-contents__link toc-highlight">Compiling cartridges</a></li><li><a href="#compiling-optimized-cartridges" class="table-of-contents__link toc-highlight">Compiling optimized cartridges</a></li><li><a href="#debugging-cartridges" class="table-of-contents__link toc-highlight">Debugging cartridges</a></li><li><a href="#inspecting-cartridges" class="table-of-contents__link toc-highlight">Inspecting cartridges</a></li><li><a href="#benchmarking-cartridges" class="table-of-contents__link toc-highlight">Benchmarking cartridges</a></li><li><a href="#customizing-sdk-to-install-new-tools" class="table-of-contents__link toc-highlight">Customizing SDK to install new tools</a></li><li><a href="#using-other-programming-languages" class="table-of-contents__link toc-highlight">Using other programming languages</a></li><li><a href="#using-scripting-languages" class="table-of-contents__link toc-highlight">Using scripting languages</a></li><li><a href="#porting-other-games" class="table-of-contents__link toc-highlight">Porting other games</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Learn</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/category/riv">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/FQnQqKWVn8" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/rives_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/rives-io" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 RIVES</div></div></div></footer></div>
</body>
</html>